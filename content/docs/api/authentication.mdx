---
title: "Authentication"
description: "OAuth and JWT authentication"
---

# Authentication

OAuth and JWT authentication

## Initiate OAuth login

<MethodBadge method="GET" path="/auth/oauth/{provider}/login" />

Redirects to OAuth provider login page

### Parameters

| Name | Type | Location | Required | Description |
|------|------|----------|----------|-------------|
| `provider` | string (google, github, shopify) | path | Yes |  |
| `redirect_uri` | string | query | No | Post-login redirect URL |

### Code Examples

<CodeTabs samples={[
  {
    language: "cURL",
    code: `curl -X GET "https://searchaf.antfly.io/api/v1/auth/oauth/{provider}/login?redirect_uri=value" \\\\
    -H "Authorization: Bearer YOUR_API_KEY"`
  },
  {
    language: "TypeScript",
    code: `const response = await fetch('https://searchaf.antfly.io/api/v1/auth/oauth/{provider}/login?redirect_uri=value', {
    method: 'GET',
    headers: {
        'Authorization': 'Bearer YOUR_API_KEY'
    }
});

const data = await response.json();`
  },
  {
    language: "JavaScript",
    code: `fetch('https://searchaf.antfly.io/api/v1/auth/oauth/{provider}/login?redirect_uri=value', {
    method: 'GET',
    headers: {
        'Authorization': 'Bearer YOUR_API_KEY'
    }
})
    .then(response => response.json())
    .then(data => console.log(data));`
  },
  {
    language: "Python",
    code: `import requests

headers = {
    'Authorization': 'Bearer YOUR_API_KEY'
}

response = requests.get('https://searchaf.antfly.io/api/v1/auth/oauth/{provider}/login?redirect_uri=value', headers=headers)

data = response.json()`
  },
  {
    language: "Go",
    code: `package main

import (
    "bytes"
    "encoding/json"
    "net/http"
)

func main() {
    req, _ := http.NewRequest("GET", "https://searchaf.antfly.io/api/v1/auth/oauth/{provider}/login?redirect_uri=value", nil)
    req.Header.Set("Authorization", "Bearer YOUR_API_KEY")

    client := &http.Client{}
    resp, _ := client.Do(req)
    defer resp.Body.Close()
}`
  }
]} />

### Responses

<ResponseTabs responses={[
  {
    statusCode: "200",
    description: "OAuth provider redirect URL (alternative to 302 redirect)",
    body: `{
  "redirect_url": "https://example.com"
}`
  },
  {
    statusCode: "302",
    description: "Redirect to OAuth provider",
  },
  {
    statusCode: "400",
    description: "Bad Request",
  }
]} />


---

## OAuth callback handler

<MethodBadge method="GET" path="/auth/oauth/{provider}/callback" />

Handles OAuth provider callback and generates JWT

### Parameters

| Name | Type | Location | Required | Description |
|------|------|----------|----------|-------------|
| `provider` | string (google, github, shopify) | path | Yes |  |
| `code` | string | query | Yes | OAuth authorization code |
| `state` | string | query | Yes | CSRF protection state |

### Code Examples

<CodeTabs samples={[
  {
    language: "cURL",
    code: `curl -X GET "https://searchaf.antfly.io/api/v1/auth/oauth/{provider}/callback?code=value&state=value" \\\\
    -H "Authorization: Bearer YOUR_API_KEY"`
  },
  {
    language: "TypeScript",
    code: `const response = await fetch('https://searchaf.antfly.io/api/v1/auth/oauth/{provider}/callback?code=value&state=value', {
    method: 'GET',
    headers: {
        'Authorization': 'Bearer YOUR_API_KEY'
    }
});

const data = await response.json();`
  },
  {
    language: "JavaScript",
    code: `fetch('https://searchaf.antfly.io/api/v1/auth/oauth/{provider}/callback?code=value&state=value', {
    method: 'GET',
    headers: {
        'Authorization': 'Bearer YOUR_API_KEY'
    }
})
    .then(response => response.json())
    .then(data => console.log(data));`
  },
  {
    language: "Python",
    code: `import requests

headers = {
    'Authorization': 'Bearer YOUR_API_KEY'
}

response = requests.get('https://searchaf.antfly.io/api/v1/auth/oauth/{provider}/callback?code=value&state=value', headers=headers)

data = response.json()`
  },
  {
    language: "Go",
    code: `package main

import (
    "bytes"
    "encoding/json"
    "net/http"
)

func main() {
    req, _ := http.NewRequest("GET", "https://searchaf.antfly.io/api/v1/auth/oauth/{provider}/callback?code=value&state=value", nil)
    req.Header.Set("Authorization", "Bearer YOUR_API_KEY")

    client := &http.Client{}
    resp, _ := client.Do(req)
    defer resp.Body.Close()
}`
  }
]} />

### Responses

<ResponseTabs responses={[
  {
    statusCode: "200",
    description: "Authentication successful",
    body: `{
  "access_token": "string",
  "refresh_token": "string",
  "token_type": "Bearer",
  "expires_in": 3600,
  "user": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "email": "user@example.com",
    "display_name": "John Doe",
    "avatar_url": "https://example.com/avatar.jpg",
    "created_at": "2025-10-02T15:30:00Z",
    "updated_at": "2025-10-02T15:30:00Z",
    "last_login_at": "2025-10-02T15:30:00Z",
    "status": "active",
    "settings": {}
  }
}`
  },
  {
    statusCode: "400",
    description: "Bad Request",
  },
  {
    statusCode: "401",
    description: "Unauthorized",
  }
]} />


---

## Link OAuth provider to account

<MethodBadge method="GET" path="/auth/oauth/{provider}/link" />

Initiate OAuth flow to link provider to authenticated user account

### Security

Provide your bearer token in the Authorization header when making requests to protected resources.

Example: `Authorization: Bearer YOUR_API_KEY`

### Parameters

| Name | Type | Location | Required | Description |
|------|------|----------|----------|-------------|
| `provider` | string (google, github, shopify) | path | Yes |  |
| `redirect_uri` | string | query | No | Post-link redirect URL |

### Code Examples

<CodeTabs samples={[
  {
    language: "cURL",
    code: `curl -X GET "https://searchaf.antfly.io/api/v1/auth/oauth/{provider}/link?redirect_uri=value" \\\\
    -H "Authorization: Bearer YOUR_API_KEY"`
  },
  {
    language: "TypeScript",
    code: `const response = await fetch('https://searchaf.antfly.io/api/v1/auth/oauth/{provider}/link?redirect_uri=value', {
    method: 'GET',
    headers: {
        'Authorization': 'Bearer YOUR_API_KEY'
    }
});

const data = await response.json();`
  },
  {
    language: "JavaScript",
    code: `fetch('https://searchaf.antfly.io/api/v1/auth/oauth/{provider}/link?redirect_uri=value', {
    method: 'GET',
    headers: {
        'Authorization': 'Bearer YOUR_API_KEY'
    }
})
    .then(response => response.json())
    .then(data => console.log(data));`
  },
  {
    language: "Python",
    code: `import requests

headers = {
    'Authorization': 'Bearer YOUR_API_KEY'
}

response = requests.get('https://searchaf.antfly.io/api/v1/auth/oauth/{provider}/link?redirect_uri=value', headers=headers)

data = response.json()`
  },
  {
    language: "Go",
    code: `package main

import (
    "bytes"
    "encoding/json"
    "net/http"
)

func main() {
    req, _ := http.NewRequest("GET", "https://searchaf.antfly.io/api/v1/auth/oauth/{provider}/link?redirect_uri=value", nil)
    req.Header.Set("Authorization", "Bearer YOUR_API_KEY")

    client := &http.Client{}
    resp, _ := client.Do(req)
    defer resp.Body.Close()
}`
  }
]} />

### Responses

<ResponseTabs responses={[
  {
    statusCode: "200",
    description: "OAuth provider redirect URL (alternative to 302 redirect)",
    body: `{
  "redirect_url": "https://example.com"
}`
  },
  {
    statusCode: "302",
    description: "Redirect to OAuth provider",
  },
  {
    statusCode: "400",
    description: "Bad Request",
  },
  {
    statusCode: "401",
    description: "Unauthorized",
  },
  {
    statusCode: "409",
    description: "Response",
  }
]} />


---

## Refresh JWT token

<MethodBadge method="POST" path="/auth/refresh" />

Generate new JWT from refresh token

### Request Body

**Content-Type:** `application/json`

### Code Examples

<CodeTabs samples={[
  {
    language: "cURL",
    code: `curl -X POST "https://searchaf.antfly.io/api/v1/auth/refresh" \\\\
    -H "Authorization: Bearer YOUR_API_KEY"`
  },
  {
    language: "TypeScript",
    code: `const response = await fetch('https://searchaf.antfly.io/api/v1/auth/refresh', {
    method: 'POST',
    headers: {
        'Authorization': 'Bearer YOUR_API_KEY'
    }
});

const data = await response.json();`
  },
  {
    language: "JavaScript",
    code: `fetch('https://searchaf.antfly.io/api/v1/auth/refresh', {
    method: 'POST',
    headers: {
        'Authorization': 'Bearer YOUR_API_KEY'
    }
})
    .then(response => response.json())
    .then(data => console.log(data));`
  },
  {
    language: "Python",
    code: `import requests

headers = {
    'Authorization': 'Bearer YOUR_API_KEY'
}

response = requests.post('https://searchaf.antfly.io/api/v1/auth/refresh', headers=headers)

data = response.json()`
  },
  {
    language: "Go",
    code: `package main

import (
    "bytes"
    "encoding/json"
    "net/http"
)

func main() {
    req, _ := http.NewRequest("POST", "https://searchaf.antfly.io/api/v1/auth/refresh", nil)
    req.Header.Set("Authorization", "Bearer YOUR_API_KEY")

    client := &http.Client{}
    resp, _ := client.Do(req)
    defer resp.Body.Close()
}`
  }
]} />

### Responses

<ResponseTabs responses={[
  {
    statusCode: "200",
    description: "Token refreshed",
    body: `{
  "access_token": "string",
  "refresh_token": "string",
  "token_type": "Bearer",
  "expires_in": 3600,
  "user": {
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "email": "user@example.com",
    "display_name": "John Doe",
    "avatar_url": "https://example.com/avatar.jpg",
    "created_at": "2025-10-02T15:30:00Z",
    "updated_at": "2025-10-02T15:30:00Z",
    "last_login_at": "2025-10-02T15:30:00Z",
    "status": "active",
    "settings": {}
  }
}`
  },
  {
    statusCode: "401",
    description: "Unauthorized",
  }
]} />


---

## Sign out user

<MethodBadge method="POST" path="/auth/signout" />

Clears authentication cookies (access_token and refresh_token)

### Code Examples

<CodeTabs samples={[
  {
    language: "cURL",
    code: `curl -X POST "https://searchaf.antfly.io/api/v1/auth/signout" \\\\
    -H "Authorization: Bearer YOUR_API_KEY"`
  },
  {
    language: "TypeScript",
    code: `const response = await fetch('https://searchaf.antfly.io/api/v1/auth/signout', {
    method: 'POST',
    headers: {
        'Authorization': 'Bearer YOUR_API_KEY'
    }
});

const data = await response.json();`
  },
  {
    language: "JavaScript",
    code: `fetch('https://searchaf.antfly.io/api/v1/auth/signout', {
    method: 'POST',
    headers: {
        'Authorization': 'Bearer YOUR_API_KEY'
    }
})
    .then(response => response.json())
    .then(data => console.log(data));`
  },
  {
    language: "Python",
    code: `import requests

headers = {
    'Authorization': 'Bearer YOUR_API_KEY'
}

response = requests.post('https://searchaf.antfly.io/api/v1/auth/signout', headers=headers)

data = response.json()`
  },
  {
    language: "Go",
    code: `package main

import (
    "bytes"
    "encoding/json"
    "net/http"
)

func main() {
    req, _ := http.NewRequest("POST", "https://searchaf.antfly.io/api/v1/auth/signout", nil)
    req.Header.Set("Authorization", "Bearer YOUR_API_KEY")

    client := &http.Client{}
    resp, _ := client.Do(req)
    defer resp.Body.Close()
}`
  }
]} />

### Responses

<ResponseTabs responses={[
  {
    statusCode: "200",
    description: "Successfully signed out",
    body: `{
  "success": true
}`
  },
  {
    statusCode: "204",
    description: "Successfully signed out, cookies cleared",
  },
  {
    statusCode: "400",
    description: "Bad Request",
  }
]} />


---

## Exchange API key for JWT

<MethodBadge method="POST" path="/auth/apikey/exchange" />

Exchange a long-lived API key for a short-lived JWT token.
The JWT can then be used to authenticate subsequent search and batch requests.


### Request Body

**Content-Type:** `application/json`

### Code Examples

<CodeTabs samples={[
  {
    language: "cURL",
    code: `curl -X POST "https://searchaf.antfly.io/api/v1/auth/apikey/exchange" \\\\
    -H "Authorization: Bearer YOUR_API_KEY"`
  },
  {
    language: "TypeScript",
    code: `const response = await fetch('https://searchaf.antfly.io/api/v1/auth/apikey/exchange', {
    method: 'POST',
    headers: {
        'Authorization': 'Bearer YOUR_API_KEY'
    }
});

const data = await response.json();`
  },
  {
    language: "JavaScript",
    code: `fetch('https://searchaf.antfly.io/api/v1/auth/apikey/exchange', {
    method: 'POST',
    headers: {
        'Authorization': 'Bearer YOUR_API_KEY'
    }
})
    .then(response => response.json())
    .then(data => console.log(data));`
  },
  {
    language: "Python",
    code: `import requests

headers = {
    'Authorization': 'Bearer YOUR_API_KEY'
}

response = requests.post('https://searchaf.antfly.io/api/v1/auth/apikey/exchange', headers=headers)

data = response.json()`
  },
  {
    language: "Go",
    code: `package main

import (
    "bytes"
    "encoding/json"
    "net/http"
)

func main() {
    req, _ := http.NewRequest("POST", "https://searchaf.antfly.io/api/v1/auth/apikey/exchange", nil)
    req.Header.Set("Authorization", "Bearer YOUR_API_KEY")

    client := &http.Client{}
    resp, _ := client.Do(req)
    defer resp.Body.Close()
}`
  }
]} />

### Responses

<ResponseTabs responses={[
  {
    statusCode: "200",
    description: "JWT token generated successfully",
    body: `{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "expires_in": 1800
}`
  },
  {
    statusCode: "400",
    description: "Bad Request",
  },
  {
    statusCode: "401",
    description: "Unauthorized",
  },
  {
    statusCode: "500",
    description: "Internal server error",
    body: `{
  "type": "https://searchaf.antfly.io/errors/validation-error",
  "title": "Validation Error",
  "status": 400,
  "detail": "Email address is required",
  "instance": "https://searchaf.antfly.io/api/v1/users/550e8400-e29b-41d4-a716-446655440000",
  "errors": [
    {
      "field": "string",
      "message": "string"
    }
  ]
}`
  }
]} />


