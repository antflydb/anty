---
title: "Subscriptions"
description: "Subscription management"
---

# Subscriptions

Subscription management

## Get subscription

<MethodBadge method="GET" path="/organizations/{org_id}/subscription" />

Get organization subscription details

### Security

Provide your bearer token in the Authorization header when making requests to protected resources.

Example: `Authorization: Bearer YOUR_API_KEY`

### Parameters

| Name | Type | Location | Required | Description |
|------|------|----------|----------|-------------|
| `org_id` | string | path | Yes | Organization ID |

### Code Examples

<CodeTabs samples={[
  {
    language: "cURL",
    code: `curl -X GET "https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription" \\\\
    -H "Authorization: Bearer YOUR_API_KEY"`
  },
  {
    language: "TypeScript",
    code: `const response = await fetch('https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription', {
    method: 'GET',
    headers: {
        'Authorization': 'Bearer YOUR_API_KEY'
    }
});

const data = await response.json();`
  },
  {
    language: "JavaScript",
    code: `fetch('https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription', {
    method: 'GET',
    headers: {
        'Authorization': 'Bearer YOUR_API_KEY'
    }
})
    .then(response => response.json())
    .then(data => console.log(data));`
  },
  {
    language: "Python",
    code: `import requests

headers = {
    'Authorization': 'Bearer YOUR_API_KEY'
}

response = requests.get('https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription', headers=headers)

data = response.json()`
  },
  {
    language: "Go",
    code: `package main

import (
    "bytes"
    "encoding/json"
    "net/http"
)

func main() {
    req, _ := http.NewRequest("GET", "https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription", nil)
    req.Header.Set("Authorization", "Bearer YOUR_API_KEY")

    client := &http.Client{}
    resp, _ := client.Do(req)
    defer resp.Body.Close()
}`
  }
]} />

### Responses

<ResponseTabs responses={[
  {
    statusCode: "200",
    description: "Subscription details",
    body: `{
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "organization_id": "550e8400-e29b-41d4-a716-446655440000",
    "stripe_customer_id": "string",
    "stripe_subscription_id": "string",
    "status": "active",
    "plan_type": "free",
    "billing_cycle_start": "2025-10-02",
    "billing_cycle_end": "2025-10-02",
    "created_at": "2025-10-02T15:30:00Z",
    "updated_at": "2025-10-02T15:30:00Z"
}`
  },
  {
    statusCode: "401",
    description: "Unauthorized",
  },
  {
    statusCode: "403",
    description: "Forbidden",
  },
  {
    statusCode: "404",
    description: "Not Found",
  }
]} />


---

## Create subscription

<MethodBadge method="POST" path="/organizations/{org_id}/subscription" />

Create Stripe subscription for organization (requires admin+ role)

### Security

Provide your bearer token in the Authorization header when making requests to protected resources.

Example: `Authorization: Bearer YOUR_API_KEY`

### Parameters

| Name | Type | Location | Required | Description |
|------|------|----------|----------|-------------|
| `org_id` | string | path | Yes | Organization ID |

### Request Body

**Example:**

```json
{
    "plan_type": "free",
    "payment_method_id": "pm_1234567890"
}
```

### Code Examples

<CodeTabs samples={[
  {
    language: "cURL",
    code: `curl -X POST "https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription" \\\\
    -H "Authorization: Bearer YOUR_API_KEY" \\\\
    -H "Content-Type: application/json" \\\\
    -d '{
    "plan_type": "free",
    "payment_method_id": "pm_1234567890"
}'`
  },
  {
    language: "TypeScript",
    code: `const response = await fetch('https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription', {
    method: 'POST',
    headers: {
        'Authorization': 'Bearer YOUR_API_KEY',
        'Content-Type': 'application/json'
    },
    body: JSON.stringify({
        "plan_type": "free",
        "payment_method_id": "pm_1234567890"
    })
});

const data = await response.json();`
  },
  {
    language: "JavaScript",
    code: `fetch('https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription', {
    method: 'POST',
    headers: {
        'Authorization': 'Bearer YOUR_API_KEY',
        'Content-Type': 'application/json'
    },
    body: JSON.stringify({
        "plan_type": "free",
        "payment_method_id": "pm_1234567890"
    })
})
    .then(response => response.json())
    .then(data => console.log(data));`
  },
  {
    language: "Python",
    code: `import requests

headers = {
    'Authorization': 'Bearer YOUR_API_KEY'
}

response = requests.post(
    'https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription',
    headers=headers,
    json={
        "plan_type": "free",
        "payment_method_id": "pm_1234567890"
    }
)

data = response.json()`
  },
  {
    language: "Go",
    code: `package main

import (
    "bytes"
    "encoding/json"
    "net/http"
)

func main() {
    body := []byte(\`{
    "plan_type": "free",
    "payment_method_id": "pm_1234567890"
}\`)
    req, _ := http.NewRequest("POST", "https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription", bytes.NewBuffer(body))
    req.Header.Set("Authorization", "Bearer YOUR_API_KEY")
    req.Header.Set("Content-Type", "application/json")

    client := &http.Client{}
    resp, _ := client.Do(req)
    defer resp.Body.Close()
}`
  }
]} />

### Responses

<ResponseTabs responses={[
  {
    statusCode: "201",
    description: "Subscription created",
    body: `{
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "organization_id": "550e8400-e29b-41d4-a716-446655440000",
    "stripe_customer_id": "string",
    "stripe_subscription_id": "string",
    "status": "active",
    "plan_type": "free",
    "billing_cycle_start": "2025-10-02",
    "billing_cycle_end": "2025-10-02",
    "created_at": "2025-10-02T15:30:00Z",
    "updated_at": "2025-10-02T15:30:00Z"
}`
  },
  {
    statusCode: "400",
    description: "Bad Request",
  },
  {
    statusCode: "401",
    description: "Unauthorized",
  },
  {
    statusCode: "403",
    description: "Forbidden",
  },
  {
    statusCode: "404",
    description: "Not Found",
  },
  {
    statusCode: "409",
    description: "Response",
  }
]} />


---

## Update subscription

<MethodBadge method="PATCH" path="/organizations/{org_id}/subscription" />

Update subscription plan (requires admin+ role)

### Security

Provide your bearer token in the Authorization header when making requests to protected resources.

Example: `Authorization: Bearer YOUR_API_KEY`

### Parameters

| Name | Type | Location | Required | Description |
|------|------|----------|----------|-------------|
| `org_id` | string | path | Yes | Organization ID |

### Request Body

**Example:**

```json
{
    "plan_type": "free",
    "payment_method_id": "string"
}
```

### Code Examples

<CodeTabs samples={[
  {
    language: "cURL",
    code: `curl -X PATCH "https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription" \\\\
    -H "Authorization: Bearer YOUR_API_KEY" \\\\
    -H "Content-Type: application/json" \\\\
    -d '{
    "plan_type": "free",
    "payment_method_id": "string"
}'`
  },
  {
    language: "TypeScript",
    code: `const response = await fetch('https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription', {
    method: 'PATCH',
    headers: {
        'Authorization': 'Bearer YOUR_API_KEY',
        'Content-Type': 'application/json'
    },
    body: JSON.stringify({
        "plan_type": "free",
        "payment_method_id": "string"
    })
});

const data = await response.json();`
  },
  {
    language: "JavaScript",
    code: `fetch('https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription', {
    method: 'PATCH',
    headers: {
        'Authorization': 'Bearer YOUR_API_KEY',
        'Content-Type': 'application/json'
    },
    body: JSON.stringify({
        "plan_type": "free",
        "payment_method_id": "string"
    })
})
    .then(response => response.json())
    .then(data => console.log(data));`
  },
  {
    language: "Python",
    code: `import requests

headers = {
    'Authorization': 'Bearer YOUR_API_KEY'
}

response = requests.patch(
    'https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription',
    headers=headers,
    json={
        "plan_type": "free",
        "payment_method_id": "string"
    }
)

data = response.json()`
  },
  {
    language: "Go",
    code: `package main

import (
    "bytes"
    "encoding/json"
    "net/http"
)

func main() {
    body := []byte(\`{
    "plan_type": "free",
    "payment_method_id": "string"
}\`)
    req, _ := http.NewRequest("PATCH", "https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription", bytes.NewBuffer(body))
    req.Header.Set("Authorization", "Bearer YOUR_API_KEY")
    req.Header.Set("Content-Type", "application/json")

    client := &http.Client{}
    resp, _ := client.Do(req)
    defer resp.Body.Close()
}`
  }
]} />

### Responses

<ResponseTabs responses={[
  {
    statusCode: "200",
    description: "Subscription updated",
    body: `{
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "organization_id": "550e8400-e29b-41d4-a716-446655440000",
    "stripe_customer_id": "string",
    "stripe_subscription_id": "string",
    "status": "active",
    "plan_type": "free",
    "billing_cycle_start": "2025-10-02",
    "billing_cycle_end": "2025-10-02",
    "created_at": "2025-10-02T15:30:00Z",
    "updated_at": "2025-10-02T15:30:00Z"
}`
  },
  {
    statusCode: "400",
    description: "Bad Request",
  },
  {
    statusCode: "401",
    description: "Unauthorized",
  },
  {
    statusCode: "403",
    description: "Forbidden",
  },
  {
    statusCode: "404",
    description: "Not Found",
  }
]} />


---

## Cancel subscription

<MethodBadge method="DELETE" path="/organizations/{org_id}/subscription" />

Cancel subscription (requires admin+ role, downgrades to free)

### Security

Provide your bearer token in the Authorization header when making requests to protected resources.

Example: `Authorization: Bearer YOUR_API_KEY`

### Parameters

| Name | Type | Location | Required | Description |
|------|------|----------|----------|-------------|
| `org_id` | string | path | Yes | Organization ID |

### Code Examples

<CodeTabs samples={[
  {
    language: "cURL",
    code: `curl -X DELETE "https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription" \\\\
    -H "Authorization: Bearer YOUR_API_KEY"`
  },
  {
    language: "TypeScript",
    code: `const response = await fetch('https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription', {
    method: 'DELETE',
    headers: {
        'Authorization': 'Bearer YOUR_API_KEY'
    }
});

const data = await response.json();`
  },
  {
    language: "JavaScript",
    code: `fetch('https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription', {
    method: 'DELETE',
    headers: {
        'Authorization': 'Bearer YOUR_API_KEY'
    }
})
    .then(response => response.json())
    .then(data => console.log(data));`
  },
  {
    language: "Python",
    code: `import requests

headers = {
    'Authorization': 'Bearer YOUR_API_KEY'
}

response = requests.delete('https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription', headers=headers)

data = response.json()`
  },
  {
    language: "Go",
    code: `package main

import (
    "bytes"
    "encoding/json"
    "net/http"
)

func main() {
    req, _ := http.NewRequest("DELETE", "https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription", nil)
    req.Header.Set("Authorization", "Bearer YOUR_API_KEY")

    client := &http.Client{}
    resp, _ := client.Do(req)
    defer resp.Body.Close()
}`
  }
]} />

### Responses

<ResponseTabs responses={[
  {
    statusCode: "204",
    description: "Subscription canceled",
  },
  {
    statusCode: "401",
    description: "Unauthorized",
  },
  {
    statusCode: "403",
    description: "Forbidden",
  },
  {
    statusCode: "404",
    description: "Not Found",
  }
]} />


---

## Create billing/checkout session

<MethodBadge method="POST" path="/organizations/{org_id}/subscription/portal" />

Smart billing endpoint that automatically routes users based on their subscription status:
- **Paid plan users** → Redirected to Stripe Billing Portal (manage payment, view invoices, cancel)
- **Free plan users** → Redirected to Stripe Checkout (upgrade to paid plan)

The response includes a `type` field indicating which flow was used.


### Security

Provide your bearer token in the Authorization header when making requests to protected resources.

Example: `Authorization: Bearer YOUR_API_KEY`

### Parameters

| Name | Type | Location | Required | Description |
|------|------|----------|----------|-------------|
| `org_id` | string | path | Yes | Organization ID |

### Request Body

**Example:**

```json
{
    "return_url": "https://searchaf.antfly.io/settings/billing",
    "plan": "growth"
}
```

### Code Examples

<CodeTabs samples={[
  {
    language: "cURL",
    code: `curl -X POST "https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription/portal" \\\\
    -H "Authorization: Bearer YOUR_API_KEY" \\\\
    -H "Content-Type: application/json" \\\\
    -d '{
    "return_url": "https://searchaf.antfly.io/settings/billing",
    "plan": "growth"
}'`
  },
  {
    language: "TypeScript",
    code: `const response = await fetch('https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription/portal', {
    method: 'POST',
    headers: {
        'Authorization': 'Bearer YOUR_API_KEY',
        'Content-Type': 'application/json'
    },
    body: JSON.stringify({
        "return_url": "https://searchaf.antfly.io/settings/billing",
        "plan": "growth"
    })
});

const data = await response.json();`
  },
  {
    language: "JavaScript",
    code: `fetch('https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription/portal', {
    method: 'POST',
    headers: {
        'Authorization': 'Bearer YOUR_API_KEY',
        'Content-Type': 'application/json'
    },
    body: JSON.stringify({
        "return_url": "https://searchaf.antfly.io/settings/billing",
        "plan": "growth"
    })
})
    .then(response => response.json())
    .then(data => console.log(data));`
  },
  {
    language: "Python",
    code: `import requests

headers = {
    'Authorization': 'Bearer YOUR_API_KEY'
}

response = requests.post(
    'https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription/portal',
    headers=headers,
    json={
        "return_url": "https://searchaf.antfly.io/settings/billing",
        "plan": "growth"
    }
)

data = response.json()`
  },
  {
    language: "Go",
    code: `package main

import (
    "bytes"
    "encoding/json"
    "net/http"
)

func main() {
    body := []byte(\`{
    "return_url": "https://searchaf.antfly.io/settings/billing",
    "plan": "growth"
}\`)
    req, _ := http.NewRequest("POST", "https://searchaf.antfly.io/api/v1/organizations/{org_id}/subscription/portal", bytes.NewBuffer(body))
    req.Header.Set("Authorization", "Bearer YOUR_API_KEY")
    req.Header.Set("Content-Type", "application/json")

    client := &http.Client{}
    resp, _ := client.Do(req)
    defer resp.Body.Close()
}`
  }
]} />

### Responses

<ResponseTabs responses={[
  {
    statusCode: "200",
    description: "Session created successfully",
    body: `{
    "url": "https://checkout.stripe.com/c/pay/cs_test_...",
    "type": "checkout"
}`
  },
  {
    statusCode: "400",
    description: "Bad Request",
  },
  {
    statusCode: "401",
    description: "Unauthorized",
  },
  {
    statusCode: "403",
    description: "Forbidden",
  },
  {
    statusCode: "404",
    description: "Not Found",
  }
]} />


